<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Script -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- icon fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <!-- Boostrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- carousel -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">

    <!-- link CSS -->
    <link rel="stylesheet" href="/assets/css/style.css">

    <style>
        .fixed-h2 {
            height: 56px; /* Đặt chiều cao đủ cho 2 dòng */
            overflow: hidden;
        }

    </style>
    <style>
        /* CSS cho Chat Bubble */
        .chat-bubble-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .chat-bubble {
            width: 60px;
            height: 60px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            position: relative;
        }

        .chat-bubble:hover {
            transform: scale(1.1);
        }

        .chat-notification {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #ff4b4b;
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            display: none;
        }

        .chat-box {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 350px;
            height: 450px;
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            display: none;
            flex-direction: column;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .chat-header {
            background-color: #4CAF50;
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-title {
            font-weight: bold;
            font-size: 16px;
        }

        .chat-close {
            cursor: pointer;
            font-size: 20px;
        }

        .chat-body {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: #f9f9f9;
        }

        .chat-message {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .chat-message.system .message-content {
            background-color: #e9e9eb;
            color: #333;
            align-self: center;
            border-radius: 18px;
            padding: 10px 15px;
            max-width: 80%;
        }

        .chat-message.user .message-content {
            background-color: #4CAF50;
            color: white;
            align-self: flex-end;
            border-radius: 18px 18px 0 18px;
            padding: 10px 15px;
            max-width: 80%;
        }

        .chat-message.admin .message-content {
            background-color: #e9e9eb;
            color: #333;
            align-self: flex-start;
            border-radius: 18px 18px 18px 0;
            padding: 10px 15px;
            max-width: 80%;
        }

        .message-time {
            font-size: 10px;
            color: #999;
            margin-top: 4px;
        }

        .chat-message.user .message-time {
            align-self: flex-end;
        }

        .chat-message.admin .message-time {
            align-self: flex-start;
        }

        .chat-footer {
            display: flex;
            padding: 10px;
            background-color: white;
            border-top: 1px solid #e9e9eb;
        }

        .chat-footer input {
            flex: 1;
            border: none;
            background-color: #f1f1f1;
            border-radius: 20px;
            padding: 10px 15px;
            outline: none;
        }

        .chat-footer button {
            background-color: transparent;
            border: none;
            color: #4CAF50;
            font-size: 20px;
            margin-left: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-footer button:hover {
            color: #357a38;
        }
    </style>

</head>

<body class="font-sans">
<div class="header header-sticky ">
    <!-- Top Navigation -->
    <div th:insert="~{/web/fragments/header}"></div>


</div>
<!-- Carousel -->
<div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
                aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
                aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
                aria-label="Slide 3"></button>
    </div>
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img src="https://theme.hstatic.net/200000692807/1001060657/14/slideShow_f1_2.png?v=779"
                 class="d-block w-100" alt="...">
        </div>
        <div class="carousel-item">
            <img src="https://theme.hstatic.net/200000692807/1001060657/14/slideShow_f1_1.png?v=779"
                 class="d-block w-100" alt="...">
        </div>
        <div class="carousel-item">
            <img src="https://theme.hstatic.net/200000692807/1001060657/14/slideShow_f1_2.png?v=779"
                 class="d-block w-100" alt="...">
        </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
    </button>
</div>

<!-- div separate -->
<div class="flex flex-col items-center">
    <div class="text-center mt-12 my-8">
        <h2 class="text-3xl font-bold gradient-text">
            KHÁM PHÁ SẢN PHẨM CỦA CHÚNG TÔI
        </h2>
        <p class="text-gray-600 mt-2">
            Những sản phẩm tươi ngon và chất lượng nhất dành cho bạn
        </p>
        <hr class="mt-4 border-t border-gray-800">
    </div>
</div>


<!-- img more -->
<div class="container mx-auto px-2 my-8">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="relative overflow-hidden group">
            <img alt="A variety of fresh vegetables including cabbage, bell peppers, pomegranates, and more."
                 class="w-full h-full object-cover transform transition-transform duration-300 ease-out group-hover:scale-110"
                 height="400"
                 src="https://storage.googleapis.com/a1aa/image/k4-ZJvouJrN6q5OeANjGjQi7OtxR9PKM4ZyKRCOueTk.jpg"
                 width="600"/>
            <div class="absolute inset-0 flex items-center justify-center">
                <div class="bg-white bg-opacity-50 p-2 rounded">
                    <p class="text-center text-lg font-bold">RAU CỦ</p>
                    <button class="mt-2 bg-gray-800 text-white px-4 py-2 rounded">XEM THÊM</button>
                </div>
            </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div class="relative overflow-hidden group">
                <img alt="A variety of fruits including pineapple, oranges, and grapefruit."
                     class="w-full h-full object-cover transform transition-transform duration-300 ease-out group-hover:scale-110"
                     height="200"
                     src="https://storage.googleapis.com/a1aa/image/JZO2K52Zr0WolUL4f5nCIYr9AX54t4Xlyy6b9Yoha4o.jpg"
                     width="300"/>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="bg-white bg-opacity-50 p-2 rounded">
                        <p class="text-center text-lg font-bold">HOA QUẢ</p>
                        <button class="mt-2 bg-gray-800 text-white px-4 py-2 rounded">XEM THÊM</button>
                    </div>
                </div>
            </div>
            <div class="relative overflow-hidden group">
                <img alt="A variety of nuts and dried fruits including peanuts, apricots, and almonds."
                     class="w-full h-full object-cover transform transition-transform duration-300 ease-out group-hover:scale-110"
                     height="200"
                     src="https://storage.googleapis.com/a1aa/image/QMvbt9oBIgXcRe6Dvcf2LC2lM155hDDcYq1DebnJomQ.jpg"
                     width="300"/>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="bg-white bg-opacity-50 p-2 rounded">
                        <p class="text-center text-lg font-bold">CÁC LOẠI HẠT</p>
                        <button class="mt-2 bg-gray-800 text-white px-4 py-2 rounded">XEM THÊM</button>
                    </div>
                </div>
            </div>
            <div class="relative overflow-hidden group">
                <img alt="A variety of dried fruits and nuts on a black surface."
                     class="w-full h-full object-cover transform transition-transform duration-300 ease-out group-hover:scale-110"
                     height="200"
                     src="https://storage.googleapis.com/a1aa/image/kz4_vorzTHxDn6XhoEsPpD3Ow6uYPiG5gZk4TWyrm3E.jpg"
                     width="300"/>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="bg-white bg-opacity-50 p-2 rounded">
                        <p class="text-center text-lg font-bold">THỊT CÁ</p>
                        <button class="mt-2 bg-gray-800 text-white px-4 py-2 rounded">XEM THÊM</button>
                    </div>
                </div>
            </div>
            <div class="relative overflow-hidden group">
                <img alt="A variety of fresh meats and fish including salmon, chicken, and beef."
                     class="w-full h-full object-cover transform transition-transform duration-300 ease-out group-hover:scale-110"
                     height="200"
                     src="https://storage.googleapis.com/a1aa/image/TyxxrW6-DHJ1Vt-M48g7eSU1fWdWywI92K1uQp7Z5fU.jpg"
                     width="300"/>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="bg-white bg-opacity-50 p-2 rounded">
                        <p class="text-center text-lg font-bold">RAU CỦ</p>
                        <button class="mt-2 bg-gray-800 text-white px-4 py-2 rounded">XEM THÊM</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Products noi bat -->

<div class=" flex flex-col items-center  product-popular">
    <div class="text-center my-8">
        <!-- <hr class="mb-4 border-t border-gray-800"> -->
        <h1 class="text-2xl font-bold text-gray-800">SẢN PHẨM NỔI BẬT DÀNH CHO BẠN</h1>
        <p class="text-gray-600">Những sản phẩm được yêu thích và tin dùng nhất dành cho bạn</p>
        <hr class="mt-4 border-t border-gray-800">
    </div>
    <div class="container  md:grid-cols-5 gap-4 px-2 w-full">


        <div class="owl-carousel owl-theme">
            <div class="item group border border-green-300 hover:border-green-500 hover:border-2 bg-white relative overflow-hidden min-h-[300px] flex flex-col group"
                 th:each="product : ${products.getContent()}">

                <!-- Label giảm giá -->
                <div class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 text-sm"
                     th:if="${product.discount != null and product.discount > 0}"
                     th:text="${'-'+product.discount + '% OFF'}">
                </div>

                <!-- Label hết hàng -->
                <div class="absolute top-2 right-2 bg-green-200 text-green-800 px-2 py-1 text-sm"
                     th:if="${productStocks.get(product.id) == 0}">
                    Tạm hết
                </div>

                <!-- Heart button overlay -->
                <div class="heart-overlay absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-full  transition-all duration-300 group-hover:translate-x-2 group-hover:opacity-100">
                    <button class="heart-button bg-white p-2 rounded-full shadow-md"
                            th:onclick="'toggleHeart(this, ' + ${product.id} + ')'"
                            th:data-product-id="${product.id}">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500" fill="none"
                             viewBox="0 0 24 24"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                        </svg>
                    </button>
                </div>
                <a th:href="|/product/${product.id}/${product.slug}|">
                <!-- Buy button overlay -->
                    <div class="buy-overlay absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-full transition-all duration-300 group-hover:-translate-x-2 group-hover:opacity-100">
                        <button class="buy-button bg-green-500 text-white px-4 py-2 rounded-full shadow-md transition-all duration-300 hover:bg-green-600">
                            Mua hàng
                        </button>
                    </div>


                    <!-- Ảnh sản phẩm -->

                    <img alt="Thịt gà - 1kg" class="w-full h-60 object-cover"
                         th:src="${product.imageUrl}"/>


                <!-- Thông tin sản phẩm -->

                <div class="p-3 text-center flex flex-col h-full" style="min-height: 124px">
                    <p class="text-lg line-clamp-2" th:text="${product.name}">Dầu Olive hữu cơ Gusti Italia 500ml</p>
                    <div class="mt-auto">
                        <div class="flex justify-center  items-center mt-2">
                    <span class="price-new text-red-500 text-xl font-semibold mr-2"
                          th:text="${product.discount != null } ? ${#numbers.formatDecimal(productVariantPrices.get(product.id) - (productVariantPrices.get(product.id) * product.discount / 100), 0, 'COMMA', 0, 'POINT')} + '₫' :
                                          ${#numbers.formatDecimal(productVariantPrices.get(product.id), 0, 'COMMA', 0, 'POINT')} + '₫'">
                    </span>

                            <span class="price-old text-gray-500 line-through"
                                  th:if="${product.discount != null and product.discount != 0}"
                                  th:text="${#numbers.formatDecimal(productVariantPrices.get(product.id), 0, 'COMMA', 0, 'POINT')} + '₫'">
                    </span>
                            </div>
                    </div>
                </div>
                </a>
            </div>





        </div>
        <!-- Product Card -->

    </div>
</div>


<!-- Products AN NGAY -->

<div class=" flex flex-col items-center  py-10 product-readyEat">
    <div class="text-center my-8">
        <!-- <hr class="mb-4 border-t border-gray-800"> -->
        <h1 class="text-2xl font-bold text-gray-800">THỰC PHẨM ĂN LIỀN CHO CUỘC SỐNG TIỆN LỢI</h1>
        <p class="text-gray-600">Những lựa chọn nhanh chóng, tiện lợi và thơm ngon dành cho bạn</p>
        <hr class="mt-4 border-t border-gray-800">
    </div>

    <div class="container  md:grid-cols-5 gap-4 px-2 w-full">


        <div class="owl-carousel owl-theme">
            <div class="item group border border-green-500 bg-white relative overflow-hidden min-h-[300px] flex flex-col"
                 th:each="productReadyToEat : ${productReadyToEat.getContent()}">
                <div class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 text-sm"
                     th:if="${productReadyToEat.discount != null and productReadyToEat.discount > 0}"
                     th:text="${'-' + productReadyToEat.discount + '% OFF'}">-15%
                </div>
                <div class="absolute top-2 right-2 bg-green-200 text-green-800 px-2 py-1 text-sm"
                     th:if="${productStocks.get(productReadyToEat.id) ==0}">Tạm hết
                </div>

                <!-- Heart button overlay -->
                <!-- Heart button overlay -->
                <div class="heart-overlay absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-full  transition-all duration-300 group-hover:translate-x-2 group-hover:opacity-100">
                    <button class="heart-button bg-white p-2 rounded-full shadow-md"
                            th:onclick="'toggleHeart(this, ' + ${productReadyToEat.id} + ')'"
                            th:data-product-id="${productReadyToEat.id}">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500 " fill="none"
                             viewBox="0 0 24 24"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                        </svg>
                    </button>
                </div>
                <a th:href="|/product/${productReadyToEat.id}/${productReadyToEat.slug}|">
                <!-- Buy button overlay -->
                <div class="buy-overlay absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-full transition-all duration-300 group-hover:-translate-x-2 group-hover:opacity-100">
                    <button class="buy-button bg-green-500 text-white px-4 py-2 rounded-full shadow-md transition-all duration-300 hover:bg-green-600">
                        Mua hàng
                    </button>
                </div>

                <img th:alt="${productReadyToEat.name}" class="w-full h-60 object-cover"
                     th:src="${productReadyToEat.imageUrl}"/>



                <div class="p-3 text-center flex flex-col h-full" style="min-height: 124px">
                    <p class="text-lg line-clamp-2" th:text="${productReadyToEat.name}">Dầu Olive hữu cơ Gusti Italia 500ml</p>
                    <div class="mt-auto">
                        <div class="flex justify-center items-center mt-2">
                          <span class="price-new text-red-500 text-xl font-semibold mr-2"
                                th:text="${productReadyToEat.discount != null} ?
                   ${#numbers.formatDecimal(productVariantPrices.get(productReadyToEat.id) - (productVariantPrices.get(productReadyToEat.id) * productReadyToEat.discount / 100), 0, 'COMMA', 0, 'POINT')} + '₫' :
                   ${#numbers.formatDecimal(productVariantPrices.get(productReadyToEat.id), 0, 'COMMA', 0, 'POINT')} + '₫'">
                            </span>

                            <span class="price-old text-gray-500 line-through"
                                  th:if="${productReadyToEat.discount != null and productReadyToEat.discount != 0}"
                                  th:text="${#numbers.formatDecimal(productVariantPrices.get(productReadyToEat.id), 0, 'COMMA', 0, 'POINT')} + '₫'">
                                440,000₫
                            </span>
                        </div>
                    </div>
                </div>
                </a>
            </div>

        </div>
        <!-- Product Card -->

    </div>
</div>

<!-- Phi thực phẩm -->
<div class=" flex flex-col items-center  py-10 product-nonFood">
    <div class="text-center my-8">
        <!-- <hr class="mb-4 border-t border-gray-800"> -->
        <h1 class="text-2xl font-bold text-gray-800">PHI THỰC PHẨM</h1>
        <p class="text-gray-600">Những sản phẩm thiên nhiên, an toàn và bền vững cho bạn và môi trường</p>
        <hr class="mt-4 border-t border-gray-800">
    </div>

    <div class="container  md:grid-cols-5 gap-4 px-2 w-full">


        <div class="owl-carousel owl-theme">
            <div class="item group border border-green-500 bg-white relative overflow-hidden min-h-[300px] flex flex-col"
                 th:each="productNonFood : ${productNonFood.getContent()}">
                <div class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 text-sm"
                     th:if="${productNonFood.discount != null and productNonFood.discount > 0}"
                     th:text="${'-' + productNonFood.discount + '% OFF'}">-15%
                </div>
                <div class="absolute top-2 right-2 bg-green-200 text-green-800 px-2 py-1 text-sm"
                     th:if="${productStocks.get(productNonFood.id) == 0}">Tạm hết
                </div>

                <!-- Heart button overlay -->
                <!-- Heart button overlay -->
                <div class="heart-overlay absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-full  transition-all duration-300 group-hover:translate-x-2 group-hover:opacity-100">
                    <button class="heart-button bg-white p-2 rounded-full shadow-md"
                            th:onclick="'toggleHeart(this, ' + ${productNonFood.id} + ')'"
                            th:data-product-id="${productNonFood.id}">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500 " fill="none"
                             viewBox="0 0 24 24"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                        </svg>
                    </button>
                </div>

                <a th:href="|/product/${productNonFood.id}/${productNonFood.slug}|">
                <!-- Buy button overlay -->
                <div class="buy-overlay absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-full transition-all duration-300 group-hover:-translate-x-2 group-hover:opacity-100">
                    <button class="buy-button bg-green-500 text-white px-4 py-2 rounded-full shadow-md transition-all duration-300 hover:bg-green-600">
                        Mua hàng
                    </button>
                </div>

                <img th:alt="${productNonFood.name}" class="w-full h-60 object-cover"
                     th:src="${productNonFood.imageUrl}"/>



                <div class="p-3 text-center flex flex-col h-full"  style="min-height: 124px">
                    <p class="text-lg line-clamp-2" th:text="${productNonFood.name}">Dầu Olive hữu cơ Gusti Italia 500ml</p>
                    <div class="mt-auto">
                        <div class="flex justify-center items-center mt-2">
                           <span class="price-new text-red-500 text-xl font-semibold mr-2"
                                 th:text="${productNonFood.discount != null} ?
               ${#numbers.formatDecimal(productVariantPrices.get(productNonFood.id) - (productVariantPrices.get(productNonFood.id) * productNonFood.discount / 100), 0, 'COMMA', 0, 'POINT')} + '₫' :
               ${#numbers.formatDecimal(productVariantPrices.get(productNonFood.id), 0, 'COMMA', 0, 'POINT')} + '₫'">
                            </span>

                            <span class="price-old text-gray-500 line-through"
                                  th:if="${productNonFood.discount != null and productNonFood.discount != 0}"
                                      th:text="${#numbers.formatDecimal(productVariantPrices.get(productNonFood.id), 0, 'COMMA', 0, 'POINT')} + '₫'">
                                440,000₫
                            </span>
                        </div>
                    </div>
                </div>
                </a>
            </div>

        </div>
        <!-- Product Card -->

    </div>
</div>

<!-- Sản phẩm giảm giá -->

<div class=" flex flex-col items-center  py-10 product-readyEat">
    <div class="text-center my-8">
        <!-- <hr class="mb-4 border-t border-gray-800"> -->
        <h1 class="text-2xl font-bold text-gray-800">ƯU ĐÃI HẤP DẪN</h1>
        <p class="text-gray-600">Những sản phẩm chất lượng với mức giá tốt nhất dành cho bạn</p>
        <hr class="mt-4 border-t border-gray-800">
    </div>

    <div class="container  md:grid-cols-5 gap-4 px-2 w-full">


        <div class="owl-carousel owl-theme">
            <div class="item group border border-green-500 bg-white relative overflow-hidden min-h-[300px] flex flex-col"
                 th:each="productDiscountMax : ${productDiscountMax}">
                <div class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 text-sm"
                     th:if="${productDiscountMax.discount != null and productDiscountMax.discount > 0}"
                     th:text="${'-' + productDiscountMax.discount + '% OFF'}">-15%
                </div>
                <div class="absolute top-2 right-2 bg-green-200 text-green-800 px-2 py-1 text-sm"
                     th:if="${productStocks.get(productDiscountMax.id) == 0}">Tạm hết
                </div>

                <!-- Heart button overlay -->
                <!-- Heart button overlay -->
                <div class="heart-overlay absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-full  transition-all duration-300 group-hover:translate-x-2 group-hover:opacity-100">
                    <button class="heart-button bg-white p-2 rounded-full shadow-md"
                            th:onclick="'toggleHeart(this, ' + ${productDiscountMax.id} + ')'"
                            th:data-product-id="${productDiscountMax.id}">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500 " fill="none"
                             viewBox="0 0 24 24"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                        </svg>
                    </button>
                </div>
                <a th:href="|/product/${productDiscountMax.id}/${productDiscountMax.slug}|">
                <!-- Buy button overlay -->
                <div class="buy-overlay absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-full transition-all duration-300 group-hover:-translate-x-2 group-hover:opacity-100">
                    <button class="buy-button bg-green-500 text-white px-4 py-2 rounded-full shadow-md transition-all duration-300 hover:bg-green-600">
                        Mua hàng
                    </button>
                </div>

                <img th:alt="${productDiscountMax.name}" class="w-full h-60 object-cover"
                     th:src="${productDiscountMax.imageUrl}"/>


                <div class="p-3 text-center flex flex-col h-full"  style="min-height: 124px">
                    <p class="text-lg line-clamp-2" th:text="${productDiscountMax.name}">Dầu Olive hữu cơ Gusti Italia 500ml</p>
                    <div class="mt-auto">
                        <div class="flex justify-center items-center mt-2">
                           <span class="price-new text-red-500 text-xl font-semibold mr-2"
                                 th:text="${productDiscountMax.discount != null} ?
                   ${#numbers.formatDecimal(productVariantPrices.get(productDiscountMax.id) - (productVariantPrices.get(productDiscountMax.id) * productDiscountMax.discount / 100), 0, 'COMMA', 0, 'POINT')} + '₫' :
                   ${#numbers.formatDecimal(productVariantPrices.get(productDiscountMax.id), 0, 'COMMA', 0, 'POINT')} + '₫'">
                            </span>

                            <span class="price-old text-gray-500 line-through"
                                  th:if="${productDiscountMax.discount != null and productDiscountMax.discount != 0}"
                                  th:text="${#numbers.formatDecimal(productVariantPrices.get(productDiscountMax.id), 0, 'COMMA', 0, 'POINT')} + '₫'">
                                440,000₫
                            </span>
                        </div>
                    </div>
                </div>
                </a>
            </div>

        </div>
        <!-- Product Card -->

    </div>
</div>

<!-- Đối tác của chúng tôi -->
<div class="text-center partner py-10 mb-8">
    <div class="text-center my-8">
        <!-- <hr class="mb-4 border-t border-gray-800"> -->
        <h1 class="text-2xl font-bold text-gray-800">ĐỐI TÁC CỦA CHÚNG TÔI</h1>
        <!-- <p class="text-gray-600">Cùng nhau tạo nên những giá trị tốt nhất</p> -->
        <!-- <hr class="mt-4 border-t border-gray-800"> -->
    </div>

    <div class="flex justify-evenly logo-partner mt-15">
        <div class="img-patner"><img alt="Organic Food badge" class="w-40 h-40" height="100"
                                     src="/assets/img/partner-1.acdaa14aff5215ef0b98.png" width="100"/>
        </div>
        <div class="img-patner"><img alt="Organic Product badge" class="w-40 h-40" height="100"
                                     src="/assets/img/partner-2.d3e0b136f59d40cfcb93.png" width="100"/>
        </div>
        <div class="img-patner">
            <img alt="Organic Certified badge" class="w-40 h-40" height="100"
                 src="/assets/img/partner-3.d74d11a53a78a371da1f.png" width="100"/>
        </div>
        <div class="img-patner"><img alt="Organic Food badge" class="w-40 h-40" height="100"
                                     src="/assets/img/partner-4.d06d6fabb263fd107aba.png" width="100"/>
        </div>
        <div class="img-patner"><img alt="Organic Product badge" class="w-40 h-40" height="100"
                                     src="/assets/img/partner-5.c56c3b518940d863df4a.png" width="100"/>
        </div>
        <div class="img-patner">
            <img alt="Organic Certified badge" class="w-40 h-40" height="100"
                 src="/assets/img/partner-6.c56c3b518940d863df4a.png " width="100"/>
        </div>
    </div>
</div>

<!-- blog -->
<div class="container mx-auto px-4 py-8 blog">
    <h1 class="text-center text-2xl font-bold mb-4">
        Organic & Sức Khỏe
    </h1>
    <p class="text-center text-gray-600 mb-8">
        Thực phẩm hữu cơ hay còn được biết đến rộng rãi với cái tên "thực phẩm Organic", không tự dưng xuất hiện mà
        xuất phát từ nhu cầu chăm sóc sức khoẻ rất khắt khe của người tiêu dùng
    </p>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="bg-white rounded-lg shadow-md overflow-hidden" th:each="blog : ${blogs.getContent()}">
            <div class="relative">
                <img th:alt="${blog.title}" class="w-full h-48 object-cover" style="height:230px"
                     th:src="${blog.thumbnail}"
                     width="600"/>

                <!--                     src="https://storage.googleapis.com/a1aa/image/hexYomgaJudP6HTDPtfezVoMQqPJmZivDYNPWN1wQss.jpg"-->

                <div
                        class="absolute top-2 left-2 bg-green-500 text-white text-xs font-bold px-3 py-2 w-14 h-14 flex flex-col items-center justify-center rounded-full text-center leading-tight">
                    <!--                    <span th:text="${#temporals.format(blog.publishedAt, 'dd')}"></span>-->

                    <!--                    <br/>-->
                    <span th:text="${#temporals.format(blog.publishedAt, 'dd/MMM/yyyy')}"></span>
                </div>

            </div>
            <div class="p-4">
                <h2 class="text-lg font-bold mb-2 fixed-h2 line-clamp-2" th:text="${blog.title}">
                    Ngày Tết - Đặc sản dấu ấn vùng miền
                </h2>
                <p class="text-gray-600 line-clamp-2" th:text="${blog.description}">
                    Từ hàm lượng dinh dưỡng tuyệt vời, Organica giới thiệu bạn Top 25 cách chế biến hạt quinoa thành
                    những...
                </p>
            </div>
        </div>
        <!--        <div class="bg-white rounded-lg shadow-md overflow-hidden">-->
        <!--            <div class="relative">-->
        <!--                <img alt="Traditional tea and herbs" class="w-full h-48 object-cover" style="height:230px"-->
        <!--                     src="https://storage.googleapis.com/a1aa/image/tWYymJrYvAI7JTakwgal-fypXe9ymPSFAztC9QHlbS4.jpg"-->
        <!--                     width="600"/>-->
        <!--                <div-->
        <!--                        class="absolute top-2 left-2 bg-green-500 text-white text-xs font-bold px-3 py-2 w-14 h-14 flex flex-col items-center justify-center rounded-full text-center leading-tight">-->
        <!--                    05-->
        <!--                    <br/>-->
        <!--                    01/2025-->
        <!--                </div>-->
        <!--            </div>-->
        <!--            <div class="p-4">-->
        <!--                <h2 class="text-lg font-bold mb-2">-->
        <!--                    MÙI GIÀ &amp; TRÀ BÀ GIÀ SẼ CÓ MẶT TẠI SỰ KIỆN THỨ 7 4/1-->
        <!--                </h2>-->
        <!--                <p class="text-gray-600">-->
        <!--                    MÙI GIÀ &amp; TRÀ BÀ GIÀ SẼ CÓ MẶT TẠI SỰ KIỆN THỨ 7 4/1Có những mùi hương có sức...-->
        <!--                </p>-->
        <!--            </div>-->
        <!--        </div>-->
        <!--        <div class="bg-white rounded-lg shadow-md overflow-hidden">-->
        <!--            <div class="relative">-->
        <!--                <img alt="Tet Viet event poster" class="w-full h-48 object-cover" style="height:230px"-->
        <!--                     src="https://storage.googleapis.com/a1aa/image/-PSl8oq30f_Mc59IMC23SU_KWInneiByXCVQjX6ocPc.jpg"-->
        <!--                     width="600"/>-->
        <!--                <div-->
        <!--                        class="absolute top-2 left-2 bg-green-500 text-white text-xs font-bold px-3 py-2 w-14 h-14 flex flex-col items-center justify-center rounded-full text-center leading-tight">-->
        <!--                    05-->
        <!--                    <br/>-->
        <!--                    01/2025-->
        <!--                </div>-->
        <!--            </div>-->
        <!--            <div class="p-4">-->
        <!--                <h2 class="text-lg font-bold mb-2">-->
        <!--                    Sự kiện Tết Việt - Dấu Ấn Vùng Miền-->
        <!--                </h2>-->
        <!--                <p class="text-gray-600">-->
        <!--                    Tết cổ truyền – thời khắc giao hòa giữa những giá trị xưa cũ và niềm hy vọng mới ...-->
        <!--                </p>-->
        <!--            </div>-->
        <!--        </div>-->
    </div>
    <div class="mt-6 flex justify-center w-full">
        <button
                class="flex mt-6 px-5 py-2 bg-white text-green-600 font-semibold border border-green-600 rounded-full hover:bg-green-700 hover:text-green-400 transition duration-300">
            Xem thêm
        </button>
    </div>
</div>


<!-- Liên hệ -->
<section id="home-shop-map">
    <div class="home-shop-map__title">TÌM CỬA HÀNG GẦN BẠN NHẤT</div>
    <a
            class="home-shop-map__btn bttn wow animate__animated animate__bounceIn animate__delay-1s" href="/map">HỆ
        THỐNG CỬA HÀNG</a>
</section>

<!-- Fragment cho chat bubble của người dùng -->
<!--<div th:fragment="chat-bubble">-->
    <!-- Chat Bubble cho người dùng -->
    <div class="chat-bubble-container" id="chatBubbleContainer">
        <!-- Nút chat -->
        <div class="chat-bubble" id="chatBubble">
            <i class="fas fa-comments"></i>
            <span class="chat-notification" id="chatNotification">0</span>
        </div>

        <!-- Cửa sổ chat -->
        <div class="chat-box" id="chatBox">
            <div class="chat-header">
                <div class="chat-title">Hỗ trợ trực tuyến</div>
                <div class="chat-close" id="chatClose">&times;</div>
            </div>
            <div class="chat-body" id="chatBody">
                <!-- Tin nhắn hệ thống -->
                <div class="chat-message system">
                    <div class="message-content">Xin chào! Chúng tôi có thể giúp gì cho bạn?</div>
                </div>
                <!-- Tin nhắn sẽ được thêm vào đây -->
            </div>
            <div class="chat-footer">
                <input type="text" id="chatInput" placeholder="Nhập tin nhắn...">
                <button id="chatSend"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

<!-- Footer -->
<div class="bg-gray-900 text-white footer">
    <div th:insert="~{/web/fragments/footer}"></div>
</div>
<!-- Script boostrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<!-- JavaScript cho chat -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<!-- JS carousel -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>

<script src="/assets/js/main.js"></script>

<script th:inline="javascript">
    const products = [[${products}]];
    console.log("sp noi bat: ", products);
    const productStocks = [[${productStocks}]];
    console.log("so luong của sp :", productStocks);
    const productCategory = [[${productCategory}]];
    console.log("cate :", productCategory);
    const productReadyToEat = [[${productReadyToEat}]];
    console.log("sp san sang an :", productReadyToEat);
    const productNonFood = [[${productNonFood}]];
    console.log("sp khong phai thuc pham :", productNonFood);
    const productDiscountMax = [[${productDiscountMax}]];
    console.log("sp giam gia nhieu nhat :", productDiscountMax);
    const blogs = [[${blogs}]];
    console.log("blogs :", blogs);

</script>
<script >
    document.addEventListener('DOMContentLoaded', function() {
        const chatBubble = document.getElementById('chatBubble');
        const chatBox = document.getElementById('chatBox');
        const chatClose = document.getElementById('chatClose');
        const chatInput = document.getElementById('chatInput');
        const chatSend = document.getElementById('chatSend');
        const chatBody = document.getElementById('chatBody');
        let stompClient = null;
        let username = null;

        // Hiển thị/ẩn cửa sổ chat
        chatBubble.addEventListener('click', function() {
            chatBox.style.display = 'flex';
            // Nếu chưa kết nối, hiển thị hộp thoại nhập tên
            if (!username) {
                showUsernamePrompt();
            }
            // Đánh dấu thông báo là đã đọc
            document.getElementById('chatNotification').style.display = 'none';
            document.getElementById('chatNotification').textContent = '0';
        });

        chatClose.addEventListener('click', function() {
            chatBox.style.display = 'none';
        });

        // Gửi tin nhắn khi nhấn nút gửi
        chatSend.addEventListener('click', sendMessage);

        // Gửi tin nhắn khi nhấn Enter
        chatInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                sendMessage();
            }
        });

        // Hiển thị hộp thoại nhập tên
        function showUsernamePrompt() {
            const userName = prompt('Vui lòng nhập tên của bạn để bắt đầu chat:', '');
            if (userName && userName.trim() !== '') {
                username = userName.trim();
                // Kết nối WebSocket sau khi có tên người dùng
                connect(username);
                // Kích hoạt input chat sau khi có tên
                chatInput.disabled = false;
            } else {
                // Nếu không nhập tên, ẩn cửa sổ chat
                chatBox.style.display = 'none';
            }
        }

        // Kết nối WebSocket
        function connect(userName) {
            const socket = new SockJS('/ws');
            stompClient = Stomp.over(socket);

            stompClient.connect({
                'username': userName
            }, function() {
                // Subscribe để nhận tin nhắn riêng tư
                stompClient.subscribe('/user/queue/private', onMessageReceived);
                stompClient.subscribe('/user/' + userName + '/queue/private', onMessageReceived);

                // Gửi thông báo tham gia
                stompClient.send("/app/chat.addUser", {},
                    JSON.stringify({
                        sender: userName,
                        type: 'JOIN'
                    })
                );

                // Thêm tin nhắn chào mừng vào khung chat
                addMessage({
                    type: 'SYSTEM',
                    content: 'Kết nối thành công! Bạn có thể bắt đầu trò chuyện với hỗ trợ viên.'
                });
            }, onError);
        }

        function onError() {
            addMessage({
                type: 'SYSTEM',
                content: 'Không thể kết nối đến máy chủ. Vui lòng thử lại sau.'
            });
        }

        // Gửi tin nhắn
        function sendMessage() {
            const messageContent = chatInput.value.trim();

            if (messageContent && stompClient) {
                const chatMessage = {
                    sender: username,
                    content: messageContent,
                    receiver: 'admin', // Gửi đến admin
                    type: 'PRIVATE'
                };

                // Gửi tin nhắn qua WebSocket
                stompClient.send("/app/chat.sendPrivateMessage", {}, JSON.stringify(chatMessage));

                // Hiển thị tin nhắn của người dùng trong cửa sổ chat
                addMessage({
                    type: 'USER',
                    content: messageContent
                });

                // Xóa nội dung input
                chatInput.value = '';
            }
        }

        // Xử lý khi nhận được tin nhắn
        function onMessageReceived(payload) {
            const message = JSON.parse(payload.body);

            // Nếu là tin nhắn từ admin
            if (message.sender === 'admin' && message.receiver === username) {
                addMessage({
                    type: 'ADMIN',
                    content: message.content
                });

                // Hiển thị thông báo nếu cửa sổ chat đang đóng
                if (chatBox.style.display !== 'flex') {
                    const notification = document.getElementById('chatNotification');
                    notification.style.display = 'flex';

                    // Tăng số lượng thông báo nếu đã có
                    const count = parseInt(notification.textContent) || 0;
                    notification.textContent = count + 1;
                }
            }
        }

        // Thêm tin nhắn vào khung chat
        function addMessage(message) {
            const messageElement = document.createElement('div');
            messageElement.classList.add('chat-message', message.type.toLowerCase());

            const contentElement = document.createElement('div');
            contentElement.classList.add('message-content');
            contentElement.textContent = message.content;
            messageElement.appendChild(contentElement);

            // Thêm thời gian
            const timeElement = document.createElement('div');
            timeElement.classList.add('message-time');
            const now = new Date();
            timeElement.textContent = now.getHours().toString().padStart(2, '0') + ':' +
                now.getMinutes().toString().padStart(2, '0');
            messageElement.appendChild(timeElement);

            chatBody.appendChild(messageElement);

            // Cuộn xuống tin nhắn mới nhất
            chatBody.scrollTop = chatBody.scrollHeight;
        }
    });
</script>
</body>
</html>